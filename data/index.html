<!doctype html>
<html lang="de">
<head>
    <!--<meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval';">-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amis-Reader</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
      window.jQuery || document.write('<script src="jquery371slim.js"><\/script>');
    </script>
    <link rel="stylesheet" href="pure-min.css">
    <!--<link rel="stylesheet" href="pure-resp.css">-->
    <link rel="stylesheet" href="amis.css">
    <link rel="icon" type="image/png" href="data:image/png;base64,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">
</head>
<body>
<div id="layout">  <!--This is the parent `<div>` that contains the menu and the content area :: side-menu.css-->
    <!-- Menu toggle -->
    <!--<a href="#menu" id="menuLink" class="menu-link">-->
    <a id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>
    <div id="menu">
        <div class="pure-menu">
            <!--<a class="pure-menu-heading" href="#">Device</a>-->
            <span class="pure-menu-heading" name="devicetype">DeviceType</span>
            <ul class="pure-menu-list">
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-home">Z√§hler</a></li>
                <li class="pure-menu-item menu-graf"><a class="pure-menu-link" data="panel-graf">Grafik</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-log">Log</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-status">Status</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-general">Allgemein</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-wifi">WiFi</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-mqtt">MQTT</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-update">Update</a></li>
                <li class="pure-menu-item"><a class="pure-menu-link" data="panel-hist">Versionsinfo</a></li>
            </ul>
        </div>
    </div>

    <div class="content">  <!--The content `<div>` is where all your content goes.  :: side-menu.css-->
      <div class="panel" id="panel-graf">
        <div id="chart-container" class="chart">
            <br>Daten von ThingSpeak werden geladen...<br>
        </div>
        <div class="pure-g">
          <div class="pure-u-1-2">
            <button class="pure-button button-load" onclick="loadOneChannel();" style="margin-left: 10px;width:160px;">Daten nachladen:</button>
          </div>
          <div class="pure-u-1-2">
          <select style="margin-left: 10px;" id="Loads">
            <option selected="selected" value="1">1 Tag</option>
            <option value="2">2 Tage</option>
            <option value="3">3 Tage</option>
            <option value="4">4 Tage</option>
            <option value="5">5 Tage</option>
            <option value="6">6 Tage</option>
            <option value="7">7 Tage</option>
            <option value="8">8 Tage</option>
            <option value="9">9 Tage</option>
            <option value="10">10 Tage</option>
          </select>
          </div>
        </div>
        <div class="pure-g">
          <div class="pure-u-1-2">
            <button class="pure-button button-graf" style="margin-left:10px;width:160px;">Chart neu laden</button>
          </div>
          <div class="pure-u-1-2">
            <select id="ChannelSelect" style="margin-left: 10px;"></select>
          </div>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-2">Grafikdaten autom. aktualisieren</label>
          <div class="pure-u-1-2 on_off">
            <input id="Update" name="Update" type="checkbox" class="">
          </div>
        </div>
      </div>

      <div class="panel" id="panel-home">
        <div class="header">
            <h1>AMIS-Smartmeter Leser</h1>
            <br>
        </div><br>
        <div class="amis">
            <div class="pure-u-11-24">Uhrzeit (Z√§hler)</div>
            <div class="pure-u-11-24" name="now"></div>
            <div class="pure-u-11-24">1.8.0 (Energie A+)</div>
            <strong><div class="pure-u-11-24" name="1_8_0" post=" kWh" div="1000"></div></strong>
            <div class="pure-u-11-24">2.8.0 (Energie A-)</div>
            <strong><div class="pure-u-11-24" name="2_8_0" post=" kWh" div="1000"></div></strong>
            <div class="pure-u-11-24">3.8.1 (Energie R+)</div>
            <div class="pure-u-11-24" name="3_8_1" post=" kVarh" div="1000"></div>
            <div class="pure-u-11-24">4.8.1 (Energie R-)</div>
            <div class="pure-u-11-24" name="4_8_1" post=" kVarh" div="1000"></div>
            <div class="pure-u-11-24">1.7.0 (Wirk. P+)</div>
            <strong><div class="pure-u-11-24" name="1_7_0" post=" kW" div="1000"></div></strong>
            <div class="pure-u-11-24">2.7.0 (Wirk. P-)</div>
            <strong><div class="pure-u-11-24" name="2_7_0" post=" kW" div="1000"></div></strong>
            <div class="pure-u-11-24">Saldo 1.7.0-2.7.0</div>
            <strong><div class="pure-u-11-24" id="saldo"></div></strong>
            <div class="pure-u-11-24">3.7.0 (Blind. Q+)</div>
            <div class="pure-u-11-24" name="3_7_0" post=" kVar" div="1000"></div>
            <div class="pure-u-11-24">4.7.0 (Blind. Q-)</div>
            <div class="pure-u-11-24" name="4_7_0" post=" kVar" div="1000"></div>
            <div class="pure-u-11-24">1.128.0 (Inkasso)</div>
            <div class="pure-u-11-24" name="1_128_0"></div>
            <br><hr>
            <div class="pure-u-11-24">Laufzeit</div>
            <div class="pure-u-11-24" name="uptime"></div>
            <div class="pure-u-11-24">Upload ThingSpeak</div>
            <div class="pure-u-11-24" name="things_up"></div>
            <br><hr>
            <h3>Energie w√∂chentlich [kWh]</h3>
            <div class="pure-u-1">
              <table class="pure-table pure-table-striped" width="100%">
                <thead><tr><th>Tag</th><th align="right">Bezug</th><th align="right">Lfrg.</th><th align="right">Diff.</th><th align="right">√òLstg.</th></tr></thead>
                <Tbody>
                  <tr><td>Heute</td>    <td align="right" id="tdy_in"></td><td align="right" id="tdy_out"></td><td align="right" id="tdy_diff"></td><td align="right" id="perhour_tdy"></td></tr>
                  <tr><td id="wd0"></td><td align="right" id="wd_in0"></td><td align="right" id="wd_out0"></td><td align="right" id="wd_diff0"></td><td align="right" id="perhour_0"></td></tr>
                  <tr><td id="wd1"></td><td align="right" id="wd_in1"></td><td align="right" id="wd_out1"></td><td align="right" id="wd_diff1"></td><td align="right" id="perhour_1"></td></tr>
                  <tr><td id="wd2"></td><td align="right" id="wd_in2"></td><td align="right" id="wd_out2"></td><td align="right" id="wd_diff2"></td><td align="right" id="perhour_2"></td></tr>
                  <tr><td id="wd3"></td><td align="right" id="wd_in3"></td><td align="right" id="wd_out3"></td><td align="right" id="wd_diff3"></td><td align="right" id="perhour_3"></td></tr>
                  <tr><td id="wd4"></td><td align="right" id="wd_in4"></td><td align="right" id="wd_out4"></td><td align="right" id="wd_diff4"></td><td align="right" id="perhour_4"></td></tr>
                  <tr><td id="wd5"></td><td align="right" id="wd_in5"></td><td align="right" id="wd_out5"></td><td align="right" id="wd_diff5"></td><td align="right" id="perhour_5"></td></tr>
                  <tr><td id="wd6"></td><td align="right" id="wd_in6"></td><td align="right" id="wd_out6"></td><td align="right" id="wd_diff6"></td><td align="right" id="perhour_6"></td></tr>
                </Tbody>
              </table>
            </div>

            <h3>Energie monatlich[kWh]</h3>
            <div class="pure-u-1">
               <span id="month_table"></span>
            </div>
            <br><br>
        </div>
      </div>

      <div class="panel pure-form" id="panel-status">
        <div class="header">
            <h1>STATUS üõà</h1>
            <br>
        </div>
        <div class="pure-u-1 pure-u-lg-1-2 state">
            <div class="pure-u-1-2">Chip ID</div>
            <div class="pure-u-11-24"><span class="right" name="chipid"></span></div>
            <div class="pure-u-1-2">Wifi MAC</div>
            <div class="pure-u-11-24"><span class="right" name="mac"></span></div>
            <div class="pure-u-1-2">SDK version</div>
            <div class="pure-u-11-24"><span class="right" name="sdk"></span></div>
            <div class="pure-u-1-2">Core version</div>
            <div class="pure-u-11-24"><span class="right" name="core"></span></div>
            <div class="pure-u-1-2">App version</div>
            <div class="pure-u-11-24"><span class="right" name="version"></span></div>
            <div class="pure-u-1-2">App name</div>
            <div class="pure-u-11-24"><span class="right" name="app_name"></span></div>
            <div class="pure-u-1-2">Compiled [UTC]</div>
            <div class="pure-u-11-24"><span class="right" name="app_compiled_time_utc"></span></div>
            <div class="pure-u-1-2">Firmware size</div>
            <div class="pure-u-11-24"><span class="right" name="sketchsize" post=" bytes"></span></div>
            <div class="pure-u-1-2">Free space</div>
            <div class="pure-u-11-24"><span class="right" name="freesize" post=" bytes"></span></div>
            <div class="pure-u-1-2">LITTLE-FS size</div>
            <div class="pure-u-11-24"><span class="right" name="littlefs_size" post=" bytes"></span></div>
            <div class="pure-u-1-2">LITTLE-FS used</div>
            <div class="pure-u-11-24"><span class="right" name="littlefs_used" post=" bytes"></span></div>
            <div class="pure-u-1-2">Max. free block size</div>
            <div class="pure-u-11-24"><span class="right" name="max_free_blocksz" post=" bytes"></span></div>
            <div class="pure-u-1-2">Free heap</div>
            <div class="pure-u-11-24"><span class="right" name="heap_free" post=" bytes"></span></div>
            <div class="pure-u-1-2">Heap fragmentation</div>
            <div class="pure-u-11-24"><span class="right" name="heap_fragment" post=" %"></span></div>
            <div class="pure-u-1-2">Flash speed</div>
            <div class="pure-u-11-24"><span class="right" name="flashspeed" post=" Hz"></span></div>
            <div class="pure-u-1-2">Flash size</div>
            <div class="pure-u-11-24"><span class="right" name="flashsize" post=" bytes"></span></div>
            <div class="pure-u-1-2">Flash mode</div>
            <div class="pure-u-11-24"><span class="right" name="flashmode"></span></div>
            <div class="pure-u-1-2">CPU Frequ.</div>
            <div class="pure-u-11-24"><span class="right" name="cpu" post=" MHz"></span></div>
        </div>
        <div class="pure-u-1 pure-u-lg-11-24 state">
            <div class="pure-u-1-2">Network</div>
            <div class="pure-u-11-24"><span name="ssid"></span></div>
            <div class="pure-u-1-2">Channel</div>
            <div class="pure-u-11-24"><span  name="channel"></span></div>
            <div class="pure-u-1-2">RSSI</div>
            <div class="pure-u-11-24"><span name="rssi" post=" dB"></span></div>
            <div class="pure-u-1-2">IP</div>
            <div class="pure-u-11-24"><span name="deviceip"></span></div>
            <div class="pure-u-1-2">DNS</div>
            <div class="pure-u-11-24"><span name="dns"></span></div>
            <div class="pure-u-1-2">Gateway</div>
            <div class="pure-u-11-24"><span name="gateway"></span></div>
            <div class="pure-u-1-2">Netmask</div>
            <div class="pure-u-11-24"><span name="netmask"></span></div>
            <div class="pure-u-1-2">VCC</div>
            <div class="pure-u-11-24"><span class="right" name="vcc">? </span><span>mV</span></div>
            <div class="pure-u-1-2 module-mqtt">MQTT Status</div>
            <div class="pure-u-11-24 module-mqtt"><span name="mqttStatus"></span></div>
            <div class="pure-u-1-2 module-ntp">NTP Status</div>
            <div class="pure-u-11-24 module-ntp"><span name="ntpSynced"></span></div>
            <div class="pure-u-1-2 module-ntp">Current time</div>
            <div class="pure-u-11-24 module-ntp"><span name="now"></span></div>
            <div class="pure-u-1-2">Uptime</div>
            <div class="pure-u-11-24"><span name="uptime"></span></div>
        </div>
      </div>

      <div class="panel  pure-form" id="panel-general">
        <div class="header">
            <h1>Allgemein</h1>
            <!--<h3>Current configuration</h3>-->
            <br>
        </div>
        <br>
        <div class="pure-g">
            <label class="pure-u-1-3">Name Ger√§t:</label>
            <input class="pure-u-2-3 general" type="text" name="devicename" placeholder="ESP-Device" />
        </div>
            <br>
        <div class="pure-g">
            <label class="pure-u-1-3">Authentifizierung:</label>
            <div class="pure-u-1-3"><input type="checkbox" name="use_auth" id="use_auth" class="general"/></div>
        </div>
        <div class="auth_details">
          <div class="pure-g">
            <label class="pure-u-1-3">Benutzer:</label>
            <input class="pure-u-2-3 general" name="auth_user" value="Admin"/>
          </div>
          <div class="pure-g">
            <label class="pure-u-1-3">Passwort:</label>
            <input class="pure-u-2-3 general" name="auth_passwd" type="password" spellcheck="false" />
            <span class="no-select password-reveal"></span>
          </div>
        </div>
        <div class="pure-g">
            <label class="pure-u-1-3">System-Log:</label>
            <div class="pure-u-1-3"><input type="checkbox" name="log_sys" id="log_sys" class="general"/></div>
        </div>
          <br>
        <div style="display:block;">
            <div class="pure-g">
                <label class="pure-u-1-3">Amis-Key:</label>
                <input class="pure-u-2-3 general" type="text" name="amis_key"/>
            </div>
            <br>
            <div class="pure-g">
                <label class="pure-u-1-3">ThingSpeak-Highcharts aktiv:</label>
                <div class="pure-u-1-3"><input type="checkbox" name="thingspeak_aktiv" id="thingspeak_aktiv" class="general"/></div>
            </div>
            <div class="things_details">
              <div class="pure-g">
                  <label class="pure-u-1-3">Channel ID:</label>
                  <input class="pure-u-2-3 general" type="text" name="channel_id"/>
              </div>
              <div class="pure-g">
                  <label class="pure-u-1-3">Write API Key:</label>
                  <input class="pure-u-2-3 general" type="text" name="write_api_key"/>
              </div>
              <div class="pure-g">
                  <label class="pure-u-1-3">Read API Key:</label>
                  <input class="pure-u-2-3 general" type="text" name="read_api_key"/>
              </div>
              <div class="pure-g">
                  <label class="pure-u-1-3">Intervall (sec):</label>
                  <input class="pure-u-2-3 general" type="number" min="30" name="thingspeak_iv"/>
              </div>
                  <hr>
                  <br>
                  Daten f√ºr einen zweiten Z√§hler abrufen:
                  <br><br>
              <div class="pure-g">
                  <label class="pure-u-1-3">Channel ID:</label>
                  <input class="pure-u-2-3 general" type="text" name="channel_id2"/>
              </div>
              <div class="pure-g">
                  <label class="pure-u-1-3">Read API Key:</label>
                  <input class="pure-u-2-3 general" type="text" name="read_api_key2"/>
              </div>
            </div>
        </div>
        <hr><br>
        <div class="pure-g">
          <label class="pure-u-1-2 ">REST- und MQTT-API</label>
              <select class="pure-u-1-2 general" name="rest_var">
                  <option value="0">Variante 1</option>
                  <option value="1">Variante 2</option>
              </select>
          <div class="pure-u-1 hint">
            Unter http://IP-Nummer/rest kann ein einfaches REST-API abgerufen werden. Die Bezeichner der Felder orientieren sich an den Codes der Register. Hier k√∂nnen zwei Formate gew√§hlt werden:<br>
            Variante 1 mit Punkten im Bezeichner, z.B. "1.8.0", Variante 2 mit Unterstrich, z.B. "1_8_0".<br>
            Diese Einstellungen gelten auch f√ºr die per MQTT versendeten Daten!<br>
          </div>
        </div>
        <hr><br>
        <div class="pure-g">
          <div class="pure-u-3-4">Offset f√ºr Saldo 1.7.0-2.7.0 (auch negativ!)</div>
          <input class="pure-u-1-4 general" type="number" name="rest_ofs" value="0">
        </div>
        <div class="pure-g">
          <div class="pure-u-2-3">Saldo 1.7.0-2.7.0 negieren</div>
          <div class="pure-u-1-3"><input type="checkbox" name="rest_neg" id="rest_neg" class="general"/></div>
          √Ñnderungen hier werden auch ohne Neustart wirksam!
		</div>
        <hr><br>
        <div class="pure-g">
          <div class="pure-u-2-3">Reboot um 0:00 Uhr</div>
          <div class="pure-u-1-3"><input type="checkbox" name="reboot0" id="reboot0" class="general"/></div>
        </div>
        <div class="pure-g">
          <label class="pure-u-2-3">Smartmeter Emulation aktiv:</label>
            <div class="pure-u-1-3 "><input type="checkbox" name="smart_mtr" id="smart_mtr" class="general"/></div>
          <div class="pure-u-1 hint">
            Unter IP-Nummer:502 ist eine Smartmeter Emulation verf√ºgbar zum Abruf der ins Netz gelieferten/bezogenen Leistung.
            Verwendbar zB f√ºr Einspeiselimit.
          </div>
        </div>
        <hr><br>
        <div class="pure-g">
          <div class="pure-u-3-4">"Ein"-Befehl unter x Watt Saldo (zB -250W):</div>
          <input class="pure-u-1-4 general" type="number" name="switch_on" value="0" id="switch_on">
        </div>
        <div class="pure-g">
          <div class="pure-u-3-4">"Aus"-Befehl √ºber x Watt Saldo (zB 25W):</div>
          <input class="pure-u-1-4 general" type="number" name="switch_off" value="0" id="switch_off">
        </div>
		<div class="pure-g">
          <label class="pure-u-1-3">Url Ein:</label>
          <input class="pure-u-2-3 general" type="text" name="switch_url_on" id="switch_url_on" class="general"/>
        </div>
		<div class="pure-g">
          <label class="pure-u-1-3">Url Aus:</label>
          <input class="pure-u-2-3 general" type="text" name="switch_url_off" id="switch_url_off" class="general"/>
        </div>
        <div class="pure-g">
          <div class="pure-u-3-4">Schaltintervall (sec):</div>
          <input class="pure-u-1-4 general" type="number" name="switch_intervall" value="0" id="switch_intervall">
        </div>

        <hr><br>
		<div class="pure-g">
          <div class="pure-u-1-2 pure-u-sm-1-5"><progress id="prgbar_general"></progress></div>
          <div style="min-height: 40px"></div>
        </div>
        <hr>
        <div class="pure-g">
          <div class="pure-u-1">
            <button class="pure-button button-update-general">√úbernehmen</button>
            <button class="pure-button button-reboot">Neustart</button>
          </div>
        </div>
      </div>

      <div class="panel pure-form" id="panel-wifi">
        <div class="header">
            <h1>WiFi üì∂</h1>
            <h2>Ger√§tebezeichnung (Hostname) bei "Allgemein" festlegen</h2>
        </div>
        <br>
        <div class="pure-g">
          <label class="pure-u-1-3">SSID:</label>
          <input class="pure-u-2-3 wifi" name="ssid" type="text"/>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3">Passwort:</label>
          <input class="pure-u-2-3 wifi" name="wifipassword" type="password"/>
          <span class="no-select password-reveal"></span>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3 ">DHCP</label>
          <div class="pure-u-2-3 on_off"><input type="checkbox" name="dhcp" id="dhcp" class="wifi" /></div>
        </div>
        <div class="wifi_details">
          <div class="pure-g">
            <label class="pure-u-1-3">Static IP:</label>
            <input class="pure-u-2-3 wifi" name="ip_static" type="text"/>
          </div>
          <div class="pure-g">
            <label class="pure-u-1-3">Netmask:</label>
            <input class="pure-u-2-3 wifi" name="ip_netmask" type="text"/>
          </div>
          <div class="pure-g">
            <label class="pure-u-1-3">Gateway:</label>
            <input class="pure-u-2-3 wifi" name="ip_gateway" type="text"/>
          </div>
          <div class="pure-g">
            <label class="pure-u-1-3">Nameserver:</label>
            <input class="pure-u-2-3 wifi" name="ip_nameserver" type="text"/>
          </div>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3">RF-Power:</label>
          <input class="pure-u-1-3 wifi" name="rfpower" type="number" min="0" max="25" placeholder="0..25dBm"/>
          <span class="pure-u-1-3">&nbsp;&nbsp;dBm</span>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3">MDNS</label>
          <div class="pure-u-2-3 on_off"><input type="checkbox" name="mdns" class="wifi" /></div>
          <!--<div class="pure-u-1 pure-u-sm-3-5"></div>-->
          <!--<div class="pure-u-1 pure-u-sm-1-5"></div>-->
          <div class="pure-u-1 hint">
              Wenn der Browser / das BS MDNS unterst√ºtzen, kann dieses Ger√§t unter "<span name="devicename" class="wifi"></span>.local" erreicht werden.
              Das Verfahren ist auch als Bonjour bekannt.
          </div>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3 ">WiFi Sleep Mode zulassen</label>
          <div class="pure-u-2-3 on_off"><input type="checkbox" name="allow_sleep_mode" id="allow_sleep_mode" class="wifi" /></div>
          <div class="pure-u-1 hint">
            Bei WLAN-Verbindungsproblemen/-abbr√ºchen kann es helfen, den Sleep Mode zu deaktivieren. Bei ausgeschaltetem Sleep Mode wechselt das Wifi-Modul nicht in den Stromsparmodus.
          </div>
        </div>
        <!-- meks ping -->
        <div class="pure-g">
          <label class="pure-u-1-3 ">Neustart bei Ping-Fehler</label>
          <div class="pure-u-2-3 on_off"><input type="checkbox" name="pingrestart_do" id="pingrestart_do" class="wifi" /></div>
          <div class="pure-u-1 hint">
            Pingt alle INTERVALL Sekunden die angegebene IP. Nach MAX FEHLER wird ein Neustart ausgel√∂st.
          </div>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3">IP:</label>
          <input class="pure-u-2-3 wifi" name="pingrestart_ip" type="text"/>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3">Intervall:</label>
          <input class="pure-u-1-3 wifi" name="pingrestart_interval" type="number" min="60" max="3600" placeholder="60"/>
          <span class="pure-u-1-3">&nbsp;&nbsp;Sekunden</span>
        </div>
        <div class="pure-g">
          <label class="pure-u-1-3">max. Fehler:</label>
          <input class="pure-u-1-3 wifi" name="pingrestart_max" type="number" min="1" max="60" placeholder="3"/>
        </div>
        <div class="pure-g">
          <div class="pure-u-1 pure-u-sm-1-5"><progress id="prgbar_wifi"></progress></div>
          <div style="min-height:40px"></div>
        </div>
	<div class="pure-g">
          <div class="pure-u-1">
            <button class="pure-button button-update-wifi">√úbernehmen</button>
            <button class="pure-button button-reboot">Neustart</button>
          </div>
        </div>
        <hr>
        <div class="pure-g">
          <label class="pure-u-1 pure-u-sm-1-5">WiFi-Scan</label>
          <div class="pure-u-1 pure-u-sm-4-5"><span name="stations"></span></div>
        </div>
      </div>

      <div class="panel pure-form" id="panel-mqtt">
          <div class="header">
              <h1>MQTT</h1>
              <h2>Einen MQTT broker im lokalen Netzwerk definieren.</h2>
          </div>
          <br>
          <div class="pure-g">
              <label class="pure-u-1-2">MQTT aktiv:</label>
              <div class="pure-u-1-2 "><input type="checkbox" name="mqtt_enabled" id="mqtt_enabled" class="mqtt"/></div>
          </div>
          <div class="mqtt_details">
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT Broker</label>
                <input class="pure-u-1-2 mqtt" name="mqtt_broker" type="text" placeholder="IP or address of your broker" />
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT Port</label>
                <input class="pure-u-1-2 mqtt" name="mqtt_port" type="number" value="1883" />
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT User</label>
                <input class="pure-u-1-2 mqtt" name="mqtt_user" type="text" placeholder="Frei lassen wenn kein Benutzer definiert ist" autocomplete="off" />
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT Passwort</label>
                <input class="pure-u-1-2 mqtt" name="mqtt_password" type="password" placeholder="Frei lassen wenn kein Passwort definiert ist" autocomplete="new-password" spellcheck="false" />
                <span class="no-select password-reveal"></span>
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT Client ID</label>
                <input class="pure-u-1-2 mqtt" name="mqtt_clientid" type="text"/>
                <div class="pure-u-1 pure-u-sm-2-5 hint">
                    Wenn nicht definiert, wird automatisch eine ID generiert
                </div>
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT QoS</label>
                <select class="pure-u-1-2 mqtt" name="mqtt_qos">
                    <option value="0">0: At most once</option>
                    <option value="1">1: At least once</option>
                    <option value="2">2: Exactly once</option>
                </select>
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT Retain</label>
                <div class="pure-u-1-2"><input type="checkbox" name="mqtt_retain" class="mqtt"/></div>
            </div>
            <div class="pure-g">
                <label class="pure-u-1-2">MQTT Publish-Intervall/Keep Alive</label>
                <input class="pure-u-1-4 mqtt" type="number" name="mqtt_keep" min="1" max="3600" value="30"/>
                <span class="pure-u-1-4">&nbsp;&nbsp;sec</span>
                <div class="pure-u-1 hint">
                    Die publish-Message wird im definierten Intervall gesendet.
                </div>
            </div>
            <div class="pure-g">
              <label class="pure-u-1-2">MQTT publish:</label>
              <input class="pure-u-1-2 mqtt" name="mqtt_pub" type="text"/>
            </div>
            <!--<div class="pure-g">-->
              <!--<label class="pure-u-1 pure-u-sm-1-5">MQTT subscribe:</label>-->
              <!--<input class="pure-u-1 pure-u-sm-2-5 mqtt" name="mqtt_sub" type="text"/>-->
            <!--</div>-->
            <div class="pure-g">
              <label class="pure-u-1-2">MQTT Last Will:</label>
              <input class="pure-u-1-2 mqtt" name="mqtt_will" type="text"/>
            </div>
          </div>
          <hr>
          <div class="pure-g">
            <div class="pure-u-1 pure-u-sm-1-5"><progress id="prgbar_mqtt"></progress></div>
            <div style="min-height:40px"></div>
          </div>
          <div class="pure-g">
            <div class="pure-u-1">
              <button class="pure-button button-update-mqtt">√úbernehmen</button>
              <button class="pure-button button-reboot">Neustart</button>
            </div>
          </div>
      </div>

      <div class="panel pure-form" id="panel-update">
          <div class="header">
              <h1>Software-Update ‚ô∫</h1>
              <!--<h4>Configure your NTP (Network Time Protocol) servers and local configuration to keep your device time up to the second for your location.</h4>-->
            <br>
          </div>
          <br><br>
          <div class="pure-g">
            <label class="pure-u-1">Konfig speichern:</label>
            <input class="pure-u-1" type="text" name="konfigname" placeholder="File Extension: *.amis" >
            <!--<div class="pure-u-1 pure-u-sm-1-24"></div>-->
            <button class="pure-button  button-savekonfig pure-u-1 pure-u-sm-2-24">Save</button>
            <div class="pure-u-1 hint">
              Das Setup und die Wochen- und Monatsliste werden abgespeichert.
            </div>
          </div>
          <hr>
          <h2>Dateien hochladen</h2>
          <!--<br>-->
          <div class="pure-g">
              <label class="pure-u-1-5">Datei:</label>
              <input class="pure-u-4-5" name="filename" type="text" readonly />
          </div>
          <div class="pure-g">
            <div class="pure-u-1 pure-u-sm-1-5"><progress id="prgbar_update"></progress></div>
            <div style="min-height:40px"></div>
          </div>
          <div class="pure-g">
              <button class="pure-button button-upgrade-browse">Auswahl</button>
              <div class="pure-u-1-24"></div>
              <button class="pure-button button-upgrade">Update</button>
              <div class="pure-u-1-24"></div>
              <button class="pure-button button-reboot">Neustart</button>
          </div>
          <input name="upgrade" type="file" style="display:none;"/>
          <br><hr>
          <h2>Daten wiederherstellen nachdem ein File *.amis geladen wurde</h2>
          <div class="pure-u-1 pure-u-sm-4-5 hint">
            Die Daten zur Wiederherstellung werden beim Button-Click zum Amis-Reader gesendet, dort vorhandene Daten 
            werden sofort √ºberschrieben!
          </div>
          <div class="pure-g">
              <button class="pure-button  button-restore-general">Allgemein</button>
              <div class="pure-u-1 "></div>
              <button class="pure-button  button-restore-wifi">WiFi</button>
              <div class="pure-u-1"></div>
              <button class="pure-button  button-restore-mqtt">MQTT</button>
              <div class="pure-u-1"></div>
              <button class="pure-button  button-restore-week">Wochenliste</button>
              <div class="pure-u-1"></div>
              <button class="pure-button  button-restore-month">Monatsliste</button>
          </div>
      </div>

      <div class="panel amis" id="panel-log">
          <div class="header">
              <h1>LOG üóä</h1>
              <!--<h2> style="color:#555;">-->
              <h2>Ereignisse anzeigen</h2>
          </div>
          <br>
          <div class="pure-g">
            <div class="pure-u-2-5"><span name="page"></span></div>
          </div>
          <div class="pure-g">
              <div class="pure-u-1 log"><span class="terminal" name="list"></span></div>
              <!--<div class=""><span class="terminal" name="list"></span></div>-->
          </div>
          <br>
          <div class="pure-g">
            <button class="pure-button button-log-prev">Seite -</button>
            <div class="pure-u-1-24"></div>
            <button class="pure-button button-log-next">Seite +</button>
            <div class="pure-u-1-24"></div>
            <button class="pure-button button-log-clear">Log l√∂schen</button>
          </div>
          <br>
          <div class="pure-g">
            <div class="pure-u-1-3">Wochendaten</div>
            <div class="pure-u-1-3"><button class="pure-button button-hist_clear">L√∂schen</button></div>
          </div>
          <div class="pure-g">
            <div class="pure-u-1-3">Monatsdaten</div>
            <div class="pure-u-1-3"><button class="pure-button button-hist_clear2">L√∂schen</button></div>
          </div>
      </div>
      <div class="panel" id="panel-hist">
          <div class="header">
              <h1>Versionsinfo</h1>
          </div>
          <br>
          <div class="pure-g hist">
            <div class="pure-u-1">
              <h3>Version 1.4.4</h3>
              Ausgabe der Zeit (Sekunden ab 1.1.1970) des Smartmeters in der REST und MQTT-Schnittstelle
              <br>
              <h3>Version 1.4.2/1.4.3</h3>
              Bugfix Durchschnittsleistung Energie w√∂chentlich; Bugfix Thingspeak Upload
              <br>		    
              <h3>Version 1.4.1</h3>
              Bugfix Durchschnittsleistung Energie w√∂chentlich
              <br>
	      <h3>Version 1.4.0</h3>
              Verbesserungen in der Wifi Verbindung: Einstellbarer Wifi Sleep-Mode; Konfigurierbarer Ping Neustart (Netzwerk-Watchdog)<br>
              Codebereinigungen. Danke an Github User <a href="https://github.com/meks007">meks007</a> f√ºr die Mitarbeit.
              <br>
	      <h3>Version 1.3.1</h3>
              F√ºr den HTTP Schaltvorgang kann ein Schaltintervall eingestellt werden. Erst nach dieser Zeit wird eine erneute Pr√ºfung f√ºr einen Schaltvorgang durchgef√ºhrt. F√ºr den Saldowert des Schaltvorgangs wird der Mittelwert der letzten 5 Sekunden herangezogen.<br>
	      Leerzeichen im MQTT Username sind nun m√∂glich.
              <br>
              <h3>Version 1.3.0</h3>
              T√§glicher reboot um 0:00 Uhr kann in Allgemein aktiviert werden.<br>
              Ein Verbraucher kann nun direkt √ºber eine Wifi Steckdose geschalten werden. Die Steckdose muss √ºber einen http Aufruf schaltbar sein - zB Tasmota kompatible Steckdosen.<br>
              zB: Verbraucher hat 500Watt Leistungsaufnahme. "Ein" unter -500Watt (Einspeisung), "Aus" √ºber 10Watt (Bezug). Schaltvorgang alle 5sec.<br>
              <h3>Version 1.2.9</h3>
              Per ModbusTCP kann nur auch direkt die Adresse 40097 f√ºr den Saldo (32Bit sw. float) abgefragt werden.<br>
              <h3>Version 1.2.8</h3>
              Diverse kleine Verbesserungen (Webserverzugriff). Details auf Github (<a href="https://github.com/mgerhard74/amis_smartmeter_reader/pull/2">pull request #2</a>) <br>
              <h3>Version 1.2.7</h3>
              * Amis-Reader fungiert als Smartmeter-Emulator per Modbus-TCP auf Port 502.<br>
              Funktioniert mit Gen24. Stark vereinfacht auf das tats√§chliche Fxxxxxs-Polling.
              Es wird nur der Wert AC-Power korrekt behandelt, der Rest ist Fake!
              Reicht aber zB f√ºr korrekte dyn. Einspeisebegrenzung.<br>
              * Alle Einstellungen und die gespeicherten Wochen- und Monatsdaten k√∂nnen in eine Konfigurationsdatei geschrieben und nat√ºrlich
              auch wieder eingelesen werden. Da die Datei im Format JSON vorliegt, ist auch denkbar diese zu editieren.
              <br>
              <h3>Version 1.2.6</h3>
              Plausibilit√§tspr√ºfung wird auch auf Datenexport zu Thingspeak, MQTT und REST angewendet.
              <br>
              <h3>Version 1.2.5</h3>
              Plausibilit√§tspr√ºfung der Z√§hlerdaten musste eingef√ºhrt werden, weil sonst das neue File f√ºr die Monatsdaten total zugem√ºllt wird.
              Falls das schon passiert ist, den Amis-Reader ohne Kontakt zum Z√§hler in Betrieb nehmen und versuchen, die Monatsdaten im Men√ºpunkt Log zu l√∂schen.
              <br>
              <h3>Version 1.2.4</h3>
              * Neu eingef√ºhrt wurde eine Liste der monatlichen Energiewerte Bezug und Lieferung, diese wird unterhalb der Wochentagswerte dargestellt. Bitte bedenken, dass bei der Inbetriebnahme bzw. nach einem Update die momentanen Z√§hlerst√§nde als Ausgangswert der Datenaufzeichnung f√ºr den laufenden Monat gelten. Erst der Folgemonat wird zur G√§nze erfasst.
              <br>
              * Die Ausgabe der Z√§hlerregister per MQTT sieht jetzt genau so aus wie die Ausgabe per HTML/rest, es gelten auch die selben Einstellungen f√ºr das Format, welches unter "Allgemein/REST- und MQTT-API" getroffen wird.
              <br>
              <h3>Version 1.2.3</h3>
              Verbesserungen der Datenauswertung:<br>
              Der Saldo (Bezug - Lieferung) wird in der Grafik dargestellt. Diese Berechnung funktioniert auch f√ºr √§ltere Daten, da sie erst zur Laufzeit durchgef√ºhrt wird.<br>
              Das Rest-API wurde um diesen Saldo erweitert, was f√ºr Anwendungen die den √úberschu√ü ben√∂tigen vorteilhaft ist. Siehe Einstellungen/Algemein.
              <h3>Version 1.2.2</h3>
              ThingsPeak √§ndert wieder einmal sein API, MQTT wird auf Secure MQTT umgestellt. Da der daf√ºr notwendige Aufwand f√ºr einen ESP8266 ziemlich hoch ist, werden die Daten jetzt per HTTP gesendet.
              Kleine Bugs behoben.
              Update betrifft firmware.bin, index.html.
              <br>
              <h3>Version 1.2.1</h3>
              Bug in der Entschl√ºsselung behoben. Work-around in cust.js entfernt. Danke Andreas B.
              Update betrifft also firmware.bin, index.html und cust.js.
              <br>
              <h3>Version 1.2.0</h3>
              Neues Filesystem LittleFs eingef√ºhrt. Leider gehen dadurch alle Konfigurations- und Logdateien verloren.
              Kleine Bugs behoben.
              <br>
              <h3>Version 1.1.5</h3>
              Antwort auf rest-Anfrage ist gesperrt, so lange Z√§hler nicht synchron ist.
              <br>
              <h3>Version 1.1.4</h3>
              Alle Web-Dateien werden vom lokalen Server bereitgestellt, d.h. kein Nachladen aus externen Quellen ist notwendig. Ausnahme: Chart-Grafik, aber dazu ist grunds√§tzlich eine Internetverbindung notwendig.
              <br>
              Logdatei und Log-Anzeige: √ºbersteigt die Gr√∂sse der Logdatei ca. 1000 Zeilen, dann wird sie gel√∂scht und neu erzeugt. Der Seitenabruf wurde verbessert wegen Timeout-Problemen.
              <br>
              <h3>Version 1.1.3</h3>
              Leerzeichen in SSID erlaubt.
              Einige HTML-Bugs bereinigt.
              <br>
              <h3>Version 1.1.2</h3>
              Saldo 1.7.0 - 2.7.0 wird angezeigt.<br>
              Die Energie-History wurde erg√§nzt und zeigt jetzt auch die Lieferung und den Saldo per Tag an.
              <br>
              <h3>Version 1.1.1</h3>
              Einf√ºhrung Versionsinfo.<br>
              Bugfix MQTT.<br>
              Die blaue LED leuchtet jetzt dauernd, sobald eine Verbindung zu einem Router (Access-Point) aufgebaut ist.<br>
              Wenn das Modul selbst als Access-Point auftritt (Jumper gesetzt), blinkt die LED. Die Netzwerkkennung (SSID) ist dann "ESP8266_AP",
              die Verbindung kann unter 192.168.4.1 aufgebaut werden.<br>
              <h3>Version 1.1.0</h3>
              Der Datenabruf von ThingSpeak musste ge√§ndert werden, weil die bisherige Methhode mit jsonp nicht mehr unterst√ºtzt wird.
              Durch die √Ñnderung des API k√∂nnen sehr restriktive Webbrowser u.U. keine Daten mehr abrufen.<br>
              Die gesamte Oberfl√§che wurde neu gestaltet, im Hintergrund laufen jetzt alle Vorg√§nge asynchron ab. Die Betriebssicherheit
              sollte dadurch noch besser werden.
            </div>
          </div>
      </div>
    </div>
</div>

<!--<script src="chart.js"></script>-->
<script src="cust.js"></script>

</body>
</html>
